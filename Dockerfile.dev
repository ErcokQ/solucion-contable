# ------------------------------------------------------------------
# Imagen DEV – no compila, ejecuta .ts con recarga automática
# ------------------------------------------------------------------
FROM node:22.16-alpine

# 1️⃣ Carpeta de trabajo
WORKDIR /home/app

# 2️⃣ Instalamos dependencias **incluyendo devDependencies**
COPY package*.json ./
RUN npm ci

# 3️⃣ Copiamos el código (opcional; en local lo montaremos como volumen)
COPY src ./src
COPY tsconfig.json ./
COPY docs ./docs

# 4️⃣ Variables por defecto de desarrollo
ENV NODE_ENV=development \
    PORT=3000 \
    DB_HOST=mysql \
    DB_PORT=3306 \
    REDIS_HOST=redis

# 5️⃣ Comando de arranque con recarga en caliente
CMD ["npm", "run", "dev"]